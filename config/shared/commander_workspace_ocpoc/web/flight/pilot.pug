extends ../../web_includes/common/layout

block includes
  include ../../web_includes/common/common_includes.pug

block header
  i.fa-fw.fa.fa-signal
  | Pilot Display (Test)

block main
  .row
    article.col-xs-12.col-sm-12.col-md-6.col-lg-6
      #wid-Flight-HUD.jarviswidget.jarviswidget-color-blueDark(data-widget-editbutton='false',data-widget-colorbutton='false',data-widget-deletebutton='false')
        header
          span.widget-icon
            i.fa.fa-table
          h2 Attitude Indicator
        div
          .jarviswidget-editbox
            input.form-control(type='text')
          .widget-body(style='padding: 0px')
            #touchpad
              #hud(style='padding: 0px; margin-bottom: -5px;')
  .toggle_switch
    br
    table(style="width:300px")
      tbody
        tr
          td(style='width: 70px;')
            h2 Video
          td
            table
              tbody
                tr
                  td
                    table(style='width: 70px;')
                      tbody
                        tr
                          td(style='width: 15px;') OFF
                          td(style='width: 40px;')
                          td(style='width: 15px;') ON
                tr
                  td
                    label.switch
                      input(type="checkbox")
                      span(class="v_slider round")
        tr 
          td
            button.btn.btn-primary(onClick="setAltitudeOffset()") Set Altitude Offset 
          td(style="width:110px")
            input.form-control#AltitudeOffsetValue(style="margin:5px; width:100px" value="0")
          td  
            p(style="margin:5px;") M
          td
            p#AltitudeOffsetStatus(style="color:green;width:500px;text-align:end") [OK]
            
  .row.row-fluid
    article.col-xs-10.col-sm-8.col-md-6.col-lg-6(style='max-width:450px')
      #wid-VM-ArmingState.jarviswidget.jarviswidget-color-blueDark(data-widget-editbutton='false')
        header
          span.widget-icon
            i.fa.fa-table
          h2 Arming State
        div
          .jarviswidget-editbox
            input.form-control(type='text')
          .widget-body
            .table-responsive
              table.table.table-condensed
                tbody
                  tr
                    th Arming State
                    td
                      span(data-sage={tlm: [{name:'/CFS/VM/ArmingState'}]}) ---
              button.btn.btn-primary(data-sage={cmd: {name:'/CFS/VM/Arm'}}) Arm
              button.btn.btn-primary(data-sage={cmd: {name:'/CFS/VM/Disarm'}}) Disarm
              
  .row.row-fluid
    article.col-xs-10.col-sm-8.col-md-6.col-lg-6(style='max-width:450px')
      #wid-VM-NavState.jarviswidget.jarviswidget-color-blueDark(data-widget-editbutton='false')
        header
          span.widget-icon
            i.fa.fa-table
          h2 Navigation State
        div
          .jarviswidget-editbox
            input.form-control(type='text')
          .widget-body
            .table-responsive
              table.table.table-condensed
                tbody
                  tr
                    th Nav State
                    td
                      span(data-sage={tlm: [{name:'/CFS/VM/NavState'}]}) ---
            footer
              button.btn.btn-primary(data-sage={cmd: {name:'/CFS/VM/SetNavManual'}}) Manual
              button.btn.btn-primary(data-sage={cmd: {name:'/CFS/VM/SetNavAltCtl'}}) AltCtl
              button.btn.btn-primary(data-sage={cmd: {name:'/CFS/VM/SetNavPosCtl'}}) PosCtl
              button.btn.btn-primary(data-sage={cmd: {name:'/CFS/VM/SetNavAutoLoiter'}}) Loiter 
              button.btn.btn-primary(data-sage={cmd: {name:'/CFS/VM/SetNavAutoRTL'}}) Auto RTL 
              button.btn.btn-primary(data-sage={cmd: {name:'/CFS/VM/SetNavAcro'}}) Acro 
              button.btn.btn-primary(data-sage={cmd: {name:'/CFS/VM/SetNavStabilize'}}) Stabilize  
              button.btn.btn-primary(data-sage={cmd: {name:'/CFS/VM/SetNavRattitude'}}) Rattitude  
              button.btn.btn-primary(data-sage={cmd: {name:'/CFS/VM/SetNavAutoTakeoff'}}) Auto Takeoff  
              button.btn.btn-primary(data-sage={cmd: {name:'/CFS/VM/SetNavAutoLand'}}) Auto Land

  script.
    var Position = {Lat: 0, Lon: 0, Alt: 0};
    var Attitude = {Yaw: 0, Pitch: 0, Roll: 0};
    var HUDCount = 0;
    var HUDStarted = false;

    //flyToLocation();

    /* Heads Up Display */

    var draw;
    var curHeading = 0;
    var curPitch = 0;
    var curRoll = 0;
    var curAltitude = 0.0;
    var textHeading;
    var hdTicks;
    var hdTicksMask;
    var hdWidth;
    var hudHeight;
    var hudWidth;
    var pxPer15Degrees;
    var pxPerDegree;
    var degPerPitchLine = 15;
    var posPitchLineOnScreen = 3.5;
    var pxPerPitchLine;
    var pxPerDegreePitch;
    var pitchIndicator;
    var altPosMetersOnScreen = 5;
    var altPxPerMeter;
    var altitudeIndicator;
    var textAltitude;
    var altTicks;
    var OffsetY = 0;
    var rotation = 0;
    var hrzWidth;
    var cameraImage;
    var imageBuffer;
    var Q = [];
    var AltOffset = 0;
    var prevTS = 0;
    var currTS = 0;
    var ctr = 0;
    var fps = 0;

    var GetTime = function(){
        var d = new Date();
        var seconds = d.getTime()/1000;
        return seconds;
    }
    var setAltitudeOffset = function(){
        try{
            AltOffset = parseFloat($("#AltitudeOffsetValue").val());
            if(isNaN(AltOffset)){
                throw "[ERROR] Input NaN";
            }
            $("#AltitudeOffsetStatus").css("color","green");
            $("#AltitudeOffsetStatus").text("[OK]");
        }
        catch(e){
            $("#AltitudeOffsetStatus").css("color","red");
            $("#AltitudeOffsetStatus").text(e);
            
        }
    }
    
    session.subscribe({
        homogeneity: {tolerance: 0}, tlm: [
            {'name': '/CFS/PX4/VA_Q_0'},
            {'name': '/CFS/PX4/VA_Q_1'},
            {'name': '/CFS/PX4/VA_Q_2'},
            {'name': '/CFS/PX4/VA_Q_3'}
        ]
      },
      function (params) {
        for (var i = 0; i < params.length; ++i) {
          switch (params[i].id.name) {
            case '/CFS/PX4/VA_Q_0':
              Q[0] = params[i].engValue.floatValue;
              break;
              
            case '/CFS/PX4/VA_Q_1':
              Q[1] = params[i].engValue.floatValue;
              break;
              
            case '/CFS/PX4/VA_Q_2':
              Q[2] = params[i].engValue.floatValue;
              break;
              
            case '/CFS/PX4/VA_Q_3':
              Q[3] = params[i].engValue.floatValue;
              break;
          }
        }
        
        //var phi = Math.atan2((Q[2]*Q[3])+(Q[0]*Q[1]), 0.5 - (Q[1]*Q[1])-(Q[2]*Q[2]));
        //var theta = Math.asin(-2*((Q[1]*Q[3])-(Q[0]*Q[2])));
        //var psi = Math.atan2((Q[1]*Q[2])-(Q[0]*Q[3]),0.5-((Q[2]*Q[2])+(Q[3]*Q[3])));
        
        var phi = Math.atan2(2*((Q[2]*Q[3])+(Q[0]*Q[1])), 1.0-2.0*(Q[1]*Q[1])-(Q[2]*Q[2]));
        var t = 2.0 * (Q[0]*Q[2]+Q[1]*Q[3]);
        if(t>1){
        t = 1;
        }
        else if(t<-1){
        t = -1;
        }
        var theta =Math.asin(t);
        var psi = Math.atan2(2.0*((Q[1]*Q[2])+(Q[0]*Q[3])),1.0-2.0*((Q[2]*Q[2])+(Q[3]*Q[3])));
      
        Attitude.Pitch = theta;
        Attitude.Roll = (-1.0)*phi;
        Attitude.Yaw = psi;

        if (HUDStarted == false) {
          /* Skip the first one. */
          HUDStarted = true;
        } else {
          HUDCount++;
        }
        
        if (HUDStarted == true) {
          updateHUDHeading(Attitude.Yaw * 57.2958);
          updateHUDPitch(Attitude.Pitch * 57.2958);
          updateHUDRoll(Attitude.Roll * 57.2958);
        }
      }
    );
    
    session.subscribe({tlm: [{'name': '/CFS/PX4/VGP_Alt'}]}, function (param) {
        Position.Alt = param.engValue.floatValue;
        updateHUDAltitude(Position.Alt);
        //console.log("alt" + Position.Alt);
    });
      
    //setInterval(function () {
    //  if (HUDStarted == true) {
    //    updateHUDAltitude(Position.Alt);
    //  }
    //}, 50);

    drawHUD();

    function updateHUDHeading(newHeading) {
      if(newHeading<0){
        newHeading = newHeading+360;
      } 
      //console.log('YAW',newHeading);
      textHeading.text(newHeading.toFixed(0).toString());
      hdTicks.x(-newHeading * pxPerDegree);
    }

    function updateHUDPitch(newPitch) {
      OffsetY = newPitch * pxPerDegreePitch;
      //pitchIndicator.rotate(0);
      //pitchIndicator.y(0);
      //pitchIndicator.animate(10, '-', 0).y(OffsetY).rotate(rotation);
    }

    function updateHUDRoll(newRoll) {
      rotation = newRoll;
      pitchIndicator.rotate(0);
      pitchIndicator.y(0);
      pitchIndicator.y(OffsetY).rotate(rotation);
    }

    function updateHUDAltitude(newAltitude) {
      if(AltOffset!=0){
        newAltitude = newAltitude + AltOffset;
      }  
      textAltitude.text(newAltitude.toFixed(1).toString());
      altTicks.y(newAltitude * altPxPerMeter);
    }

    $('#hud').on('resize', function (event) {
      //console.log("Resized");
      $('svg').remove();
      drawHUD();
      //updateHUDAltitude(10);
      //updateHUDHeading(20);
      //updateHUDPitch(30);
      //updateHUDRoll(40);
    });
    
    var toggle = 0;
    /* onload produce nosignam */
    imageBuffer = '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';
    cameraImage.load('data:image/jpeg;base64,' + imageBuffer);
    $('input:checkbox').change(
        function(){
            if ($(this).is(':checked')) {
            
                session.subscribeToVideo(function(image) {
                  if(ctr==0){
                      prevTS = GetTime();
                  }
                  if(ctr%1000==0 && ctr!=0){
                      currTS = GetTime();
                      delta = currTS-prevTS;
                      fps = Math.round(1000/delta);
                      console.log("FPS : ",fps);
                      //console.log("FPS : ",fps);
                    
                      prevTS = GetTime();
                  }
                  imageBuffer = image;
                  cameraImage.load('data:image/jpeg;base64,' + imageBuffer);
                  //console.log(imageBuffer);
                  ctr++;
                });
                
            }
            else{
                session.unSubscribeToVideo();

            }
        }
    );

    function drawHUD() {
      var aspectRatio = 320.0 / 180.0;
      hudWidth = $('#hud').width();
      hudHeight = hudWidth / aspectRatio;
      if ($(window).height() < hudHeight) {
        hudHeight = $(window).height() - 50;
        hudWidth = hudHeight * aspectRatio;
      }
      draw = SVG('hud').size('100%', hudHeight);

      if (SVG.supported == false) {
        alert('SVG not supported with ths browser.');
      }
      else {
        var bgOpacity = 0.5;
        var rect = draw.rect('100%', '100%').attr({fill: '#000000'});
        //draw.fixSubPixelOffset();
        draw.attr('preserveAspectRatio', 'x320Y180 meet');

        /* -------------------------
         Draw the camera video
         ------------------------- */
        //var defs = draw.defs();
        //$("#SvgjsImage2653").attr("href",'data:image/jpeg;base64,' + imageBuffer);
        //var cameraVideoClip = defs.clip().rect(hudWidth, hudHeight).move(0, 0);
        cameraImage = draw.image('data:image/jpeg;base64,' + imageBuffer, hudWidth, hudHeight);
        delete cameraImage;
        delete imageBuffer;

        var rollIndicator = draw.group();

        /* -------------------------
         Draw altimeter
         ------------------------- */
        var altWidth = 50;
        var altHeight = hudHeight - 10;
        var altWidth = 50;
        var altHeight = hudHeight - 10;
        altPxPerMeter = altHeight / altPosMetersOnScreen;
        var altPxPerDecimeter = altPxPerMeter / 10.0;
        var altPxPerCentimeter = altPxPerMeter / 100.0;
        var altPxPerMillimeter = altPxPerMeter / 1000.0;

        var altimeter = draw.group();
        var altBorder = altimeter.group();
        /* Draw border. */
        var altRec1 = altBorder.rect(altWidth, altHeight).attr({
          x: hudWidth - altWidth - 5,
          y: 5,
          stroke: '#000000',
          'stroke-width': '3px',
          rx: 5,
          ry: 5,
          'fill-opacity': bgOpacity
        });
        var altRec2 = altBorder.rect(altWidth, altHeight).attr({
          x: hudWidth - altWidth - 5,
          y: 5,
          stroke: '#00ff00',
          rx: 5,
          ry: 5,
          'fill-opacity': bgOpacity
        });
        /* Draw ticks group. */
        var altTicksArea = altimeter.group();
        altTicks = altTicksArea.group();
        //console.log('test');
        for (i = 0; i < (10 * (altPosMetersOnScreen + 1 + 30)); i++) {
          y = (hudHeight / 2) - i * (altPxPerDecimeter);
          /* Draw a longer line if its a meter interval. */
          if (i % 10 == 0) {
            altTicks.line(hudWidth - altWidth - 3, y, hudWidth - altWidth + 20, y).attr({
              width: 2,
              stroke: '#00ff00'
            });

            var textAltTick = altTicks.text((i / 10.0).toString()).move(hudWidth - altWidth + 30, y - 5);
            textAltTick.font({
              fill: '#00ff00',
              anchor: 'start',
              size: 13
            });
          }
          else {
            /* This is just a decimeter tick. */
            altTicks.line(hudWidth - altWidth - 3, y, hudWidth - altWidth + 10, y).attr({
              width: 1,
              stroke: '#00ff00'
            });
          }
        }
        for (i = 0; i > (-10 * (altPosMetersOnScreen + 1)); i--) {
          y = (hudHeight / 2) - i * (altPxPerDecimeter);
          /* Draw a longer line if its a meter interval. */
          if (i % 10 == 0) {
            altTicks.line(hudWidth - altWidth - 3, y, hudWidth - altWidth + 20, y).attr({
              width: 2,
              stroke: '#00ff00'
            });

            var textAltTick = altTicks.text((i / 10.0).toString()).move(hudWidth - altWidth + 30, y - 5);
            textAltTick.font({
              fill: '#00ff00',
              anchor: 'start',
              size: 13
            });
          }
          else {
            /* This is just a decimeter tick. */
            altTicks.line(hudWidth - altWidth - 3, y, hudWidth - altWidth + 10, y).attr({
              width: 1,
              stroke: '#00ff00'
            });
          }
        }
        /* Draw center altitude indicator. */
        var altCenter = altimeter.group();
        var altCenterHeight = 30;
        altCenter.polyline([
          [hudWidth - altWidth - 5, hudHeight / 2],
          [hudWidth - altWidth + 15, (hudHeight - altCenterHeight) / 2],
          [hudWidth - 5, (hudHeight - altCenterHeight) / 2],
          [hudWidth - 5, (hudHeight + altCenterHeight) / 2],
          [hudWidth - altWidth + 15, (hudHeight + altCenterHeight) / 2],
          [hudWidth - altWidth - 5, hudHeight / 2]]).attr({
          stroke: '#000000',
          'stroke-width': 3,
          'fill-opacity': 0.0
        });
        altCenter.polyline([
          [hudWidth - altWidth - 5, hudHeight / 2],
          [hudWidth - altWidth + 15, (hudHeight - altCenterHeight) / 2],
          [hudWidth - 5, (hudHeight - altCenterHeight) / 2],
          [hudWidth - 5, (hudHeight + altCenterHeight) / 2],
          [hudWidth - altWidth + 15, (hudHeight + altCenterHeight) / 2],
          [hudWidth - altWidth - 5, hudHeight / 2]]).attr({
          stroke: '#00ff00',
          'stroke-width': 2,
          'fill-opacity': 0.0
        });
        textAltitude = altCenter.text('0.0').move(hudWidth - altWidth + 12, (hudHeight / 2)-2);
        //textAltitude.attr("dominant-baseline", "middle");
        textAltitude.font({
          fill: '#00ff00',
          size: 12,
        });
        var altTicksMask = altimeter.mask();
        altTicksMask.rect(hudWidth, hudHeight).attr({
          fill: '#000000'
        });
        altTicksMask.rect(altWidth, altHeight).attr({
          x: hudWidth - altWidth - 5,
          y: 5,
          fill: '#ffffff',
          'stroke-width': '3px',
          rx: 5,
          ry: 5
        });
        altTicksMask.polyline([
          [hudWidth - altWidth - 5, hudHeight / 2],
          [hudWidth - altWidth + 15, (hudHeight - altCenterHeight) / 2],
          [hudWidth - 5, (hudHeight - altCenterHeight) / 2],
          [hudWidth - 5, (hudHeight + altCenterHeight) / 2],
          [hudWidth - altWidth + 15, (hudHeight + altCenterHeight) / 2],
          [hudWidth - altWidth - 5, hudHeight / 2]]).attr({
          fill: '#000000'
        });
        altTicksArea.maskWith(altTicksMask);

        /* -------------------------
         Draw Heading
         ------------------------- */
        var hdHeight = 50;
        hdWidth = hudWidth - 120;
        pxPer15Degrees = (hdWidth / 2) / 5;
        pxPerDegree = pxPer15Degrees / 15.0;
        var heading = draw.group();
        var headingBorder = heading.group();
        /* Draw border. */
        var hdRec1 = headingBorder.rect(hdWidth, hdHeight).attr({
          x: (hudWidth - hdWidth) / 2,
          y: hudHeight - hdHeight - 5,
          stroke: '#000000',
          'stroke-width': '3px',
          rx: 5,
          ry: 5,
          'fill-opacity': bgOpacity
        });
        var hdRec2 = headingBorder.rect(hdWidth, hdHeight).attr({
          x: (hudWidth - hdWidth) / 2,
          y: hudHeight - hdHeight - 5,
          stroke: '#00ff00',
          'stroke-width': '1px',
          rx: 5,
          ry: 5,
          'fill-opacity': bgOpacity
        });
        /* Draw ticks group. */
        hdTicksArea = heading.group();
        hdTicks = hdTicksArea.group();
        for (i = 0; i < (360 + 90); i++) {
          if (i % 15 == 0) {
            x = ((hudWidth) / 2) + (pxPerDegree * i);
            hdTicks.line(x, hudHeight - hdHeight - 3, x, hudHeight - hdHeight + 10).attr({
              width: 1,
              stroke: '#00ff00'
            });

            var fixedHeading = i;
            if (i < 0) {
              fixedHeading = 360 + i;
            }
            else if (i >= 360) {
              fixedHeading = i - 360;
            }

            var textHeadingTick = hdTicks.text(fixedHeading.toString()).move(x, hudHeight - hdHeight + 13);
            textHeadingTick.font({
              fill: '#00ff00',
              anchor: 'middle',
              size: 13
            });
          }
        }
        for (i = 0; i > (-360 - 90); i--) {
          if (i % 15 == 0) {
            x = ((hudWidth) / 2) + (pxPerDegree * i);
            hdTicks.line(x, hudHeight - hdHeight - 3, x, hudHeight - hdHeight + 10).attr({
              width: 1,
              stroke: '#00ff00'
            });

            var fixedHeading = i;
            if (i < 0) {
              fixedHeading = 360 + i;
            }
            else if (i >= 360) {
              fixedHeading = i - 360;
            }

            var textHeadingTick = hdTicks.text(fixedHeading.toString()).move(x, hudHeight - hdHeight + 13);
            textHeadingTick.font({
              fill: '#00ff00',
              anchor: 'middle',
              size: 13
            });
          }
        }
        /* Draw center heading indicator. */
        var hdCenter = heading.group();
        var hdCenterWidth = 60;
        hdCenter.polyline([
          [hudWidth / 2, hudHeight - hdHeight - 5],
          [(hudWidth + 20) / 2, hudHeight - hdHeight + 10],
          [(hudWidth + hdCenterWidth) / 2, hudHeight - hdHeight + 10],
          [(hudWidth + hdCenterWidth) / 2, hudHeight - 5],
          [(hudWidth - hdCenterWidth) / 2, hudHeight - 5],
          [(hudWidth - hdCenterWidth) / 2, hudHeight - hdHeight + 10],
          [(hudWidth - 20) / 2, hudHeight - hdHeight + 10],
          [hudWidth / 2, hudHeight - hdHeight - 5]]).attr({
          stroke: '#000000',
          'stroke-width': 3,
          'fill-opacity': 0.0
        });
        hdCenter.polyline([
          [hudWidth / 2, hudHeight - hdHeight - 5],
          [(hudWidth + 20) / 2, hudHeight - hdHeight + 10],
          [(hudWidth + hdCenterWidth) / 2, hudHeight - hdHeight + 10],
          [(hudWidth + hdCenterWidth) / 2, hudHeight - 5],
          [(hudWidth - hdCenterWidth) / 2, hudHeight - 5],
          [(hudWidth - hdCenterWidth) / 2, hudHeight - hdHeight + 10],
          [(hudWidth - 20) / 2, hudHeight - hdHeight + 10],
          [hudWidth / 2, hudHeight - hdHeight - 5]]).attr({
          stroke: '#00ff00',
          'stroke-width': 2,
          'fill-opacity': 0.0
        });
        textHeading = draw.text('0').move((hudWidth / 2), hudHeight - hdHeight + 13);
        textHeading.font({
          fill: '#00ff00',
          anchor: 'middle',
          size: 23
        });

        hdTicksMask = heading.mask();

        hdTicksMask.rect(hudWidth, hudHeight).attr({
          fill: '#000000'
        });
        hdTicksMask.rect(hdWidth, hdHeight).attr({
          x: (hudWidth - hdWidth) / 2,
          y: hudHeight - hdHeight - 5,
          stroke: '#00ff00',
          'stroke-width': '1px',
          rx: 5,
          ry: 5,
          fill: '#ffffff'
        });
        hdTicksMask.polyline([
          [hudWidth / 2, hudHeight - hdHeight - 5],
          [(hudWidth + 20) / 2, hudHeight - hdHeight + 10],
          [(hudWidth + hdCenterWidth) / 2, hudHeight - hdHeight + 10],
          [(hudWidth + hdCenterWidth) / 2, hudHeight - 5],
          [(hudWidth - hdCenterWidth) / 2, hudHeight - 5],
          [(hudWidth - hdCenterWidth) / 2, hudHeight - hdHeight + 10],
          [(hudWidth - 20) / 2, hudHeight - hdHeight + 10],
          [hudWidth / 2, hudHeight - hdHeight - 5]]).attr({
          fill: '#000000'
        });
        hdTicksArea.maskWith(hdTicksMask);

        /* -------------------------
         Draw horizon
         ------------------------- */
        hrzWidth = (hudWidth - altWidth) * 0.3;
        var hrzInterval;
        var horizonArea = draw.group();
        pxPerPitchLine = ((hudWidth / 2) / posPitchLineOnScreen);
        pxPerDegreePitch = pxPerPitchLine / degPerPitchLine;
        pitchIndicator = horizonArea.group();

        for (i = 0; i <= 90; i++) {
          if (i % degPerPitchLine == 0) {
            y = ((hudHeight) / 2) - (pxPerDegreePitch * i);

            if (i > 0) {
              pitchIndicator.polyline([
                [(hudWidth - hrzWidth) / 2, y],
                [(hudWidth - (hrzWidth * 0.10)) / 2, y],
                [hudWidth / 2, y + (hrzWidth * 0.05)],
                [(hudWidth + (hrzWidth * 0.10)) / 2, y],
                [(hudWidth + hrzWidth) / 2, y]]).attr({
                'stroke-width': 3,
                'fill-opacity': 0.0,
                stroke: '#000000'
              });
              pitchIndicator.polyline([
                [(hudWidth - hrzWidth) / 2, y],
                [(hudWidth - (hrzWidth * 0.10)) / 2, y],
                [hudWidth / 2, y + (hrzWidth * 0.05)],
                [(hudWidth + (hrzWidth * 0.10)) / 2, y],
                [(hudWidth + hrzWidth) / 2, y]]).attr({
                'stroke-width': 2,
                'fill-opacity': 0.0,
                stroke: '#00ff00'
              });

              var fixedPitch = i;
              if (i > 90) {
                fixedPitch = 180 - i;
              }

              pitchIndicator.rect(20, 20).attr({
                fill: '#000000',
                x: (hudWidth - hrzWidth) / 2 - 22,
                y: y - 10,
                'fill-opacity': bgOpacity,
              });
              var leftTextPitchLine = pitchIndicator.text(fixedPitch.toString()).move((hudWidth - hrzWidth) / 2 - 5, y - 7);
              leftTextPitchLine.font({
                fill: '#00ff00',
                anchor: 'end',
                size: 15,
              });

              pitchIndicator.rect(20, 20).attr({
                fill: '#000000',
                x: (hudWidth + hrzWidth) / 2 + 3,
                y: y - 10,
                'fill-opacity': bgOpacity,
              });
              var rightTextPitchLine = pitchIndicator.text(fixedPitch.toString()).move((hudWidth + hrzWidth) / 2 + 5, y - 7);
              rightTextPitchLine.font({
                fill: '#00ff00',
                anchor: 'start',
                size: 15,
              });
            }
            else {
              pitchIndicator.line(-hudWidth, y, 2 * hudWidth, y).attr({
                'stroke-width': 3,
                stroke: '#000000'
              });
              pitchIndicator.line(-hudWidth, y, 2 * hudWidth, y).attr({
                'stroke-width': 2,
                stroke: '#00ff00'
              });
            }
          }
        }

        for (i = 0; i >= -90; i--) {
          if (i % degPerPitchLine == 0) {
            y = ((hudHeight) / 2) - (pxPerDegreePitch * i);

            if (i < 0) {
              pitchIndicator.polyline([
                [(hudWidth - hrzWidth) / 2, y],
                [(hudWidth - (hrzWidth * 0.10)) / 2, y],
                [hudWidth / 2, y - (hrzWidth * 0.05)],
                [(hudWidth + (hrzWidth * 0.10)) / 2, y],
                [(hudWidth + hrzWidth) / 2, y]]).attr({
                'stroke-width': 3,
                'fill-opacity': 0.0,
                stroke: '#000000'
              });
              pitchIndicator.polyline([
                [(hudWidth - hrzWidth) / 2, y],
                [(hudWidth - (hrzWidth * 0.10)) / 2, y],
                [hudWidth / 2, y - (hrzWidth * 0.05)],
                [(hudWidth + (hrzWidth * 0.10)) / 2, y],
                [(hudWidth + hrzWidth) / 2, y]]).attr({
                'stroke-width': 2,
                'fill-opacity': 0.0,
                stroke: '#00ff00'
              });

              var fixedPitch = i;
              if (i < -90) {
                fixedPitch = -180 - i;
              }

              pitchIndicator.rect(25, 20).attr({
                fill: '#000000',
                x: (hudWidth - hrzWidth) / 2 - 27,
                y: y - 10,
                'fill-opacity': bgOpacity,
              });
              var leftTextPitchLine = pitchIndicator.text(fixedPitch.toString()).move((hudWidth - hrzWidth) / 2 - 5, y - 7);
              leftTextPitchLine.font({
                fill: '#00ff00',
                anchor: 'end',
                size: 15,
              });

              pitchIndicator.rect(25, 20).attr({
                fill: '#000000',
                x: (hudWidth + hrzWidth) / 2 + 3,
                y: y - 10,
                'fill-opacity': bgOpacity,
              });
              var rightTextPitchLine = pitchIndicator.text(fixedPitch.toString()).move((hudWidth + hrzWidth) / 2 + 5, y - 7);
              rightTextPitchLine.font({
                fill: '#00ff00',
                anchor: 'start',
                size: 15,
              });
            }
          }
        }

        hrzMask = pitchIndicator.mask();
        hrzMask.rect(hudWidth, hudHeight).attr({
          fill: '#000000'
        });
        hrzMask.rect(hudWidth - altWidth - 20, hudHeight - hdHeight - 20).attr({
          fill: '#ffffff',
          x: 5,
          y: 5
        });
        horizonArea.maskWith(hrzMask);
      }
    }

    var pitchDirection = 0.2;
    var altitudeDirection = 0.01;

     
